{% comment %}
  News Thumbnail Snippet
  
  Parameters:
  - news_item: News item object (required)
  - loading: Image loading attribute (optional, default: "lazy")
  
  Usage:
  {% render 'snippets/news-thumbnail', news_item: news_item %}
{% endcomment %}

{% assign image_loading = loading | default: "lazy" %}
{% comment %} Get title - API client normalizes to camelCase, so check camelCase first, then PascalCase {% endcomment %}
{% assign news_title = news_item.title | default: news_item.Title | default: news_item.name | default: news_item.Name | default: news_item.slug | default: news_item.Slug | default: news_item.id | default: news_item.Id %}
{% comment %} Get slug - check camelCase first {% endcomment %}
{% assign news_slug = news_item.slug | default: news_item.Slug | default: news_item.id | default: news_item.Id %}
{% comment %} Get excerpt - check camelCase first {% endcomment %}
{% assign news_excerpt = news_item.excerpt | default: news_item.Excerpt | default: news_item.content | default: news_item.Content | truncate: 150 %}
{% comment %} Handle ThumbnailImage object - API client normalizes to camelCase (thumbnailImage) {% endcomment %}
{% assign thumbnail_image = news_item.thumbnailImage | default: news_item.ThumbnailImage %}
{% if thumbnail_image %}
  {% comment %} Check camelCase first (url, altText), then PascalCase (Url, AltText) {% endcomment %}
  {% assign news_image = thumbnail_image.url | default: thumbnail_image.Url %}
  {% assign news_image_alt = thumbnail_image.altText | default: thumbnail_image.AltText | default: news_title %}
{% else %}
  {% comment %} Fallback to Image field if ThumbnailImage is not available {% endcomment %}
  {% assign news_image = news_item.image | default: news_item.Image %}
  {% assign news_image_alt = news_title %}
{% endif %}
{% comment %} Get published date - check camelCase first {% endcomment %}
{% assign news_published = news_item.publishedAt | default: news_item.PublishedAt | default: news_item.published_at %}
{% comment %} Get category - check camelCase first {% endcomment %}
{% assign news_category = news_item.category | default: news_item.Category %}

<div class="news-thumbnail">
  <a href="/news/{{ news_slug }}" class="news-thumbnail__link">
    {% if news_image and news_image != blank %}
      <div class="news-thumbnail__image">
        {% if news_image contains 'http://' or news_image contains 'https://' %}
          {% assign image_src = news_image %}
        {% else %}
          {% assign image_src = news_image | asset_url %}
        {% endif %}
        <img src="{{ image_src }}" alt="{{ news_image_alt }}" width="400" height="220" loading="{{ image_loading }}">
      </div>
    {% else %}
      <div class="news-thumbnail__placeholder">
        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <path d="M8 8h8M8 12h8M8 16h5"></path>
        </svg>
      </div>
    {% endif %}
    
    <div class="news-thumbnail__content">
      {% if news_category %}
        {% assign category_name = news_category.Name | default: news_category.name %}
        {% if category_name and category_name != blank %}
          <div class="news-thumbnail__category">{{ category_name }}</div>
        {% endif %}
      {% endif %}
      
      <h3 class="news-thumbnail__title">{{ news_title }}</h3>
      
      {% if news_excerpt and news_excerpt != blank %}
        <p class="news-thumbnail__excerpt">{{ news_excerpt }}</p>
      {% endif %}
      
      {% if news_published %}
        <div class="news-thumbnail__date">
          {{ news_published | date: '%b %d, %Y' }}
        </div>
      {% endif %}
    </div>
  </a>
</div>

<style>
  .news-thumbnail {
    width: 100%;
    height: 100%;
    background: #fff;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }

  .news-thumbnail:hover {
    transform: translateY(-4px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
  }

  .news-thumbnail__link {
    display: flex;
    flex-direction: column;
    height: 100%;
    text-decoration: none;
    color: inherit;
  }

  .news-thumbnail__image {
    width: 100%;
    aspect-ratio: 16 / 9;
    overflow: hidden;
    background: #f5f5f5;
  }

  .news-thumbnail__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .news-thumbnail__placeholder {
    width: 100%;
    aspect-ratio: 16 / 9;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f5f5f5;
    color: #999;
  }

  .news-thumbnail__content {
    padding: 16px;
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .news-thumbnail__category {
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #666;
  }

  .news-thumbnail__title {
    font-size: 16px;
    font-weight: 600;
    line-height: 1.4;
    margin: 0;
    color: #111;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .news-thumbnail__excerpt {
    font-size: 14px;
    line-height: 1.6;
    color: #666;
    margin: 0;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
    overflow: hidden;
    flex: 1;
  }

  .news-thumbnail__date {
    font-size: 12px;
    color: #999;
    margin-top: auto;
  }

  @media (max-width: 768px) {
    .news-thumbnail__content {
      padding: 12px;
    }

    .news-thumbnail__title {
      font-size: 14px;
    }

    .news-thumbnail__excerpt {
      font-size: 13px;
      -webkit-line-clamp: 2;
    }
  }
</style>


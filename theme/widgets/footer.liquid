{% liquid
  assign widget_settings = widget.settings
  assign widget_content = widget.content
  assign widget_data = widget.data

  assign columns = widget_data.columns | default: widget_content.columns | default: widget_settings.columns
  if columns == nil or columns == empty
    assign columns = widget_settings.links | default: widget_content.links | default: widget_data.links
  endif

  assign show_social = widget_settings.show_social
  if show_social == nil and widget_content and widget_content.show_social != nil
    assign show_social = widget_content.show_social
  endif
  if show_social == nil
    assign show_social = true
  endif

  assign social_links = widget_settings.social_links | default: widget_content.social_links | default: widget_data.social_links
%}

<footer class="widget widget-footer" data-widget-id="{{ widget.id }}">
  <div class="widget-footer__inner">
    <div class="widget-footer__brand">
      <h3>{{ widget_settings.title | default: widget_content.title | default: shop.name }}</h3>
      <p>{{ widget_settings.description | default: widget_content.description | default: shop.description }}</p>
    </div>

    {% if columns and columns.size > 0 %}
      <div class="widget-footer__columns">
        {% for column in columns %}
          <div class="widget-footer__column">
            <h4>{{ column.title | default: column.heading }}</h4>
            {% if column.links and column.links.size > 0 %}
              <ul>
                {% for link in column.links %}
                  <li>
                    <a href="{{ link.url | default: link.href | default: '#' }}">{{ link.title | default: link.label }}</a>
                  </li>
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    {% if show_social and social_links and social_links.size > 0 %}
      <div class="widget-footer__social">
        <span>{{ widget_settings.social_title | default: 'Follow us' }}</span>
        <ul>
          {% for social in social_links %}
            <li>
              <a href="{{ social.url | default: social.href | default: '#' }}" aria-label="{{ social.label | default: social.title }}">
                {% if social.icon %}
                  <img src="{{ social.icon }}" alt="{{ social.label | default: social.title }}" width="18" height="18" loading="lazy">
                {% else %}
                  {{ social.label | default: social.title }}
                {% endif %}
              </a>
            </li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  </div>

  <div class="widget-footer__bottom">
    <p>&copy; {{ 'now' | date: '%Y' }} {{ shop.name }}. {{ widget_settings.legal_text | default: 'All rights reserved.' }}</p>
    {% if widget_settings.legal_links %}
      <ul>
        {% for link in widget_settings.legal_links %}
          <li><a href="{{ link.url | default: link.href }}">{{ link.title | default: link.label }}</a></li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  <style>
    .widget-footer {
      background: {{ widget_settings.background_color | default: settings.color_background }};
      color: {{ widget_settings.text_color | default: settings.color_text }};
      padding: 3rem 1rem;
      border-top: 1px solid rgba(0,0,0,0.08);
    }
    .widget-footer__inner {
      max-width: {{ settings.container_width }}px;
      margin: 0 auto 2rem;
      display: grid;
      gap: 2rem;
    }
    .widget-footer__brand h3 {
      margin: 0 0 0.5rem;
      font-size: 1.5rem;
    }
    .widget-footer__columns {
      display: grid;
      gap: 1.5rem;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
    }
    .widget-footer__column h4 {
      margin: 0 0 1rem;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
    }
    .widget-footer__column ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: grid;
      gap: 0.5rem;
    }
    .widget-footer__column a {
      color: inherit;
      text-decoration: none;
    }
    .widget-footer__column a:hover {
      text-decoration: underline;
    }
    .widget-footer__social ul {
      list-style: none;
      margin: 0.75rem 0 0;
      padding: 0;
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }
    .widget-footer__social a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgba(255,255,255,0.08);
      color: inherit;
      text-decoration: none;
      font-size: 0.875rem;
    }
    .widget-footer__social img {
      max-width: 18px;
      max-height: 18px;
    }
    .widget-footer__bottom {
      max-width: {{ settings.container_width }}px;
      margin: 0 auto;
      padding-top: 1.5rem;
      border-top: 1px solid rgba(255,255,255,0.08);
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      font-size: 0.875rem;
    }
    .widget-footer__bottom ul {
      list-style: none;
      margin: 0;
      padding: 0;
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
    }
    .widget-footer__bottom a {
      color: inherit;
      text-decoration: none;
    }
    @media (min-width: 768px) {
      .widget-footer__inner {
        grid-template-columns: minmax(0, 1.2fr) minmax(0, 2fr);
      }
      .widget-footer__bottom {
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
      }
    }
  </style>
</footer>

